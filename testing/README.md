# Testing Procedure

While developing the ANTLR grammar, this directory is used for testing coverage. Everything is
command-line driven. Unlike the “production” processor in the parent directory, which works with the
Python code generated by ANTLR, this directory works with the Java code. It’s a bit faster, and
provides better support for tracking down problems when things go awry.

## `generate_test_data.py`

This script pulls the current set of Scribe Blocks from the local database, and saves them as text
files in a set of subdirectories: `test_data.major`, `test_data.minor`, `test_data.conc`,
`test_data.degree`, and `test_data.other`. It consults the contents of _quarantine\_list_ (see
below) and skips any blocks with known syntax errors.

## `run_tests`

This scripts trys to parse all the scribe blocks in the five test_data directories, with command
line options for selecting only some of them. Anything that fails to parse will generate an entry
in the corresponding `test\_results.xxx` dir. Generates a .csv report telling how long it took to
parse each block.

## Environment Variables and Aliases

These are set up from my login script (`~/.aliases_du_jour`):

    # While testing dgw parser
    export testing="/Users/vickery/Projects/dgw_processor/testing"
    alias testing='cd "$testing"'
    alias setit='export TEST_DATA=$TEST_DIR/`pbpaste`'
    alias tot='export saved_t=$TEST_DATA; cp $TEST_DATA ./t; export TEST_DATA=./t'
    alias fromt='export TEST_DATA=$saved_t'
    alias sublt='subl t'
    alias lt='echo $TEST_DIR; ls -l $TEST_DIR'
    alias lr='echo $RESULT_DIR; ls -lS $RESULT_DIR|m'
    alias vr='m $RESULT_DIR/`pbpaste`'
    function use {
      export TEST_DIR=test_data.$1
      export RESULT_DIR=test_results.$1
    }
    use major

## Examining Problems And Quarantining Miscreants

The _use_ function selects a block type to examine; there is a `use major` command at the end of the
login script, so _test\_data.major_ and _test\_results.major_ are the default subdirectories. The
_lr_ command lets you list the blocks that caused problems. Select the name of the file to work
with, and use the _setit_ command to copy the pathname to the clipboard. Then use the _tot_ command
to copy the file itself to the temporary file named t. Use _sublt_ to open the file in the Sublime
text editor.

